docker build -t magenta_env .

docker run --platform linux/amd64 -it --rm \
    -v $(pwd)/magenta_models:/magenta_models \
    -v $(pwd)/magenta_output:/magenta_output \
    magenta_env

melody_rnn_generate \
    --config=attention_rnn \
    --bundle_file=/magenta_models/attention_rnn.mag \
    --output_dir=/magenta_output/yeet \
    --num_outputs=5 \
    --num_steps=128 \
    --primer_melody="[60]"


## Help
magenta.models.melody_rnn.melody_rnn_generate:
  --beam_size: The beam size to use for beam search when generating melodies.
    (default: '1')
    (an integer)
  --branch_factor: The branch factor to use for beam search when generating melodies.
    (default: '1')
    (an integer)
  --bundle_description: A short, human-readable text description of the bundle (e.g., training data, hyper parameters, etc.).
  --bundle_file: Path to the bundle file. If specified, this will take priority over run_dir and checkpoint_file, unless save_generator_bundle is True, in which case both this flag and
    either run_dir or checkpoint_file are required
  --checkpoint_file: Path to the checkpoint file. run_dir will take priority over this flag.
  --log: The threshold for what messages will be logged DEBUG, INFO, WARN, ERROR, or FATAL.
    (default: 'INFO')
  --num_outputs: The number of melodies to generate. One MIDI file will be created for each.
    (default: '10')
    (an integer)
  --num_steps: The total number of steps the generated melodies should be, priming melody length + generated steps. Each step is a 16th of a bar.
    (default: '128')
    (an integer)
  --output_dir: The directory where MIDI files will be saved to.
    (default: '/tmp/melody_rnn/generated')
  --primer_melody: A string representation of a Python list of note_seq.Melody event values. For example: "[60, -2, 60, -2, 67, -2, 67, -2]". If specified, this melody will be used as
    the priming melody. If a priming melody is not specified, melodies will be generated from scratch.
    (default: '')
  --primer_midi: The path to a MIDI file containing a melody that will be used as a priming melody. If a primer melody is not specified, melodies will be generated from scratch.
    (default: '')
  --qpm: The quarters per minute to play generated output at. If a primer MIDI is given, the qpm from that will override this flag. If qpm is None, qpm will default to 120.
    (a number)
  --run_dir: Path to the directory where the latest checkpoint will be loaded from.
  --[no]save_generator_bundle: If true, instead of generating a sequence, will save this generator as a bundle file in the location specified by the bundle_file flag
    (default: 'false')
  --steps_per_iteration: The number of melody steps to take per beam search iteration.
    (default: '1')
    (an integer)
  --temperature: The randomness of the generated melodies. 1.0 uses the unaltered softmax probabilities, greater than 1.0 makes melodies more random, less than 1.0 makes melodies less
    random.
    (default: '1.0')
    (a number)


## Different outputs

### Simple middle c priming

melody_rnn_generate \
    --config=attention_rnn \
    --bundle_file=/magenta_models/attention_rnn.mag \
    --output_dir=/magenta_output/middle_c \
    --num_outputs=5 \
    --num_steps=128 \
    --primer_melody="[60]"

### C major priming

Primed on C E G, and F A C

melody_rnn_generate \
    --config=attention_rnn \
    --bundle_file=/magenta_models/attention_rnn.mag \
    --output_dir=/magenta_output/c_major \
    --num_outputs=5 \
    --num_steps=128 \
    --primer_melody="[60,64,67,65,69,72]"

### A major priming

Primed with A major ascending scale

melody_rnn_generate \
    --config=attention_rnn \
    --bundle_file=/magenta_models/attention_rnn.mag \
    --output_dir=/magenta_output/a_major \
    --num_outputs=5 \
    --num_steps=128 \
    --primer_melody="[69, 71, 73, 74, 76, 78, 80]"

### Increase temp

melody_rnn_generate \
    --config=attention_rnn \
    --bundle_file=/magenta_models/attention_rnn.mag \
    --output_dir=/magenta_output/complex_rhythm \
    --num_outputs=5 \
    --num_steps=128 \
    --primer_melody="[60, -2, 62, -1, 64, -2, 65, -1, 67, -2, 64, -1, 60, -2, 62, -1, 
                      64, -2, 65, -1, 67, -2, 62, -1, 60, -2, 62, -1, 64, -2, 65, -1, 
                      67, -2, 60, -1, 62, -2, 64, -1, 65, -2, 67, -1]" \
    --temperature=2 \
    --qpm=100

  ## Performance RNN

performance_rnn_generate \
  --config=performance_with_dynamics \
  --bundle_file=/magenta_models/performance_with_dynamics.mag \
  --output_dir=/magenta_output/performance \
  --num_outputs=3 \
  --num_steps=500 \
  --primer_melody="[60,62,64,65,67,69,71,72]" \
  --pitch_class_histogram="[2, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1]"

